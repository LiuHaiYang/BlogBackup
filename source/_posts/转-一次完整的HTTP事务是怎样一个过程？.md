---
title: 转-一次完整的HTTP事务是怎样一个过程？
date: 2021-01-28 10:46:50
tags: 网络
---

[一次完整的HTTP事务是怎样一个过程？](https://blog.51cto.com/linux5588/1351007)

#### 个人理解：

	域名解析 --> 发起TCP的3次握手 --> 建立TCP连接后发起http请求 --> 服务器响应http请求，浏览器得到html代码 --> 浏览器解析html代码，并请求html代码中的资源（如js、css、图片等） --> 浏览器对页面进行渲染呈现给用户


#### 关于HTTP协议可以参考以下：

HTTP协议漫谈  http://kb.cnblogs.com/page/140611/

HTTP协议概览  http://www.cnblogs.com/vamei/archive/2013/05/11/3069788.html

了解HTTP Headers的方方面面  http://kb.cnblogs.com/page/55442/

### 整个过程

#### 域名解析

首先Chrome浏览器会解析 `www.linux178.com `这个域名（准确的叫法应该是主机名）对应的IP地址。怎么解析到对应的IP地址？

- Chrome浏览器 会首先搜索浏览器自身的DNS缓存（缓存时间比较短，大概只有1分钟，且只能容纳1000条缓存），看自身的缓存中是否有`www.linux178.com `对应的条目，而且没有过期，如果有且没有过期则解析到此结束。

    注：我们怎么查看Chrome自身的缓存？可以使用 chrome://net-internals/#dns 来进行查看

- 如果浏览器自身的缓存里面没有找到对应的条目，那么Chrome会搜索操作系统自身的DNS缓存,如果找到且没有过期则停止搜索解析到此结束.

     注：怎么查看操作系统自身的DNS缓存，以Windows系统为例，可以在命令行下使用 ipconfig /displaydns 来进行查看  


- 如果在Windows系统的DNS缓存也没有找到，那么尝试读取hosts文件（位于C:\Windows\System32\drivers\etc），看看这里面有没有该域名对应的IP地址，如果有则解析成功。

- 如果在hosts文件中也没有找到对应的条目，浏览器就会发起一个DNS的系统调用，就会向本地配置的首选DNS服务器（一般是电信运营商提供的，也可以使用像Google提供的DNS服务器）发起域名解析请求（通过的是UDP协议向DNS的53端口发起请求，这个请求是递归的请求，也就是运营商的DNS服务器必须得提供给我们该域名的IP地址），运营商的DNS服务器首先查找自身的缓存，找到对应的条目，且没有过期，则解析成功。如果没有找到对应的条目，则有运营商的DNS代我们的浏览器发起迭代DNS解析请求，它首先是会找根域的DNS的IP地址（这个DNS服务器都内置13台根域的DNS的IP地址），找打根域的DNS地址，就会向其发起请求（请问 `www.linux178.com` 这个域名的IP地址是多少啊？），根域发现这是一个顶级域com域的一个域名，于是就告诉运营商的DNS我不知道这个域名的IP地址，但是我知道com域的IP地址，你去找它去，于是运营商的DNS就得到了com域的IP地址，又向com域的IP地址发起了请求（请问`www.linux178.com`这个域名的IP地址是多少?）,com域这台服务器告诉运营商的DNS我不知道 `www.linux178.com`这个域名的IP地址，但是我知道`linux178.com`这个域的DNS地址，你去找它去，于是运营商的DNS又向linux178.com这个域名的DNS地址（这个一般就是由域名注册商提供的，像万网，新网等）发起请求（请问 `www.linux178.com` 这个域名的IP地址是多少？），这个时候`linux178.com`域的DNS服务器一查，诶，果真在我这里，于是就把找到的结果发送给运营商的DNS服务器，这个时候运营商的DNS服务器就拿到了 `www.linux178.com `这个域名对应的IP地址，并返回给Windows系统内核，内核又把结果返回给浏览器，终于浏览器拿到了`www.linux178.com ` 对应的IP地址，该进行一步的动作了。


